# API_for_social_network v1.0
# Documentation
###### Используемый фреймворк - flask 2.3.3

#### тз:
- Создает пользователя (проверяет почту на правильность), который может писать посты, ставить реакции (heart, like, dislike, boom, ...) на посты других пользователей
- Выдает данные по конкретному пользователю
- Создает пост
- Выдает данные по конкретному посту
- Пользователь ставит реакцию на пост
- Выдает все посты пользователя, отсортированные по количеству реакций
- Генерирует список пользователей, отсортированный по количеству реакций
- Генерирует график пользователей по количеству реакций


## description of modules

### classes.py
Модуль содержит 4 основных класса, используемые в работе: 
- **User и Post**. Содержат схожие методы и атрибуты. Используются для описания одного пользователя/поста соответственно
- UserStorage и PostStorage. Являются классами-хранилищами для данных пользователя/поста соответственно. БД пока что не реализована (**_Ориентировочно будет готова к версии v2.0_**), поэтому данные хранятся в runtime

### email_checker.py
Модуль содержит функцию проверки валидности эл. почты - check_email(email). Функция выполняет команды из библиотеки email_validate -> validate()


### routes.py
Модуль является ***основным***. Содержит маршруты запросов и функции, обрабатывающие эти запросы.
Более подробное описание функций + маршруты:


- **initialization_user()** (route: "/users/create"). Создает пользователя, принимает json запрос с данными о новом пользователе. Проверяет почту на корректность + смотрит отсутствие такой же среди зарегестрированных. Возвращает json c полным описанием нового **пользователя**


- **get_user(user_id)** (r: "/users/<'user id'>"). Проверяет существование user_id в хранилище, возвращает json c полным описанием пользователя. При отсутствии user_id в хранилище возвращает json с ошибкой


- **create_post()** (r: "/posts/create"). Создает пост. Принимает json запрос со следующими данными: **"author_id"** **"text"**. Создает пост, добавляет к профилю автора поста id созданного поста. Возвращает json с полной информацией о новом посте


- **get_post(post_id)** (r: "/posts/<'post_id'>"). Проверяет существование post_id  в хранилище и возвращает json полное описание поста в случае наличия post_id или json с ошибкой в случае отсутствия 


- **put_reaction(post_id)** (r: "/post/<'post_id'>/reaction"). Ставит реакцию на пост. Принимает json запрос с названием реакции. Далее пытается найти пост с указанным id в хранилище. В случае наличия ставит на пост реакцию (в массив с реакциями класса Post добавляет название реакции). Ничего не возвращает


- **get_user_posts(user_id)** (r: "/users/<'user_id'>/posts"). Принимает json с условием сортировки: asc (по возрастанию) или desc (по убыванию). Находит пользователя в хранилище и возвращает все посты, созданные указанным пользователем в порядке, указанном в json запросе


- **show_leaderboard** (r: "/users/leaderboard"). Принимает json запрос с типом лидерборда, который вернется в ответе: **graph** (вернет ссылку на расположение файла с графиком. Используется библиотека matplotlib. График в виде столбчатой диаграммы) или **list** (также в запросе будет нужен формат сортировки (аналогичный get_user_posts). Возвращает json со всеми пользователями, отсортированными по количеству реакций на постах и количеству постов)

### usage examples

- **Создание пользователя:**
`POST /users/create`
###### request:
```
{
  "first_name": "string",
  "last_name": "string",
  "email": "string"
}
```
###### response:
```
{
  "id": "number",
  "first_name": "string",
  "last_name": "string",
  "email": "string",
  "total_reactions": "number",
  "posts": []
}
```

- **Получение данных о конкретном пользователе**
`GET /users/<user_id>`
###### response:
```
{
  "id": "number",
  "first_name": "string",
  "last_name": "string",
  "email": "string",
  "total_reactions": "number",
  "posts": [
    "number",
    ...
  ]
}
```

- **Создание поста** 
`POST /posts/create`

###### request:
```
{
  "author_id": "number",
  "text": "string"
}
```

###### response:
```
{
  "id": "number",
  "author_id": "number",
  "text": "string",
  "reactions": [
  	"string",
    ...
  ] 
}
```

- **Получение данных по определенному посту** 
`GET /posts/<post_id>`

###### response:
```
{
  "id": "number",
  "author_id": "number",
  "text": "string",
  "reactions": [
  	"string",
    ...
  ] 
}
```

- **Поставить реакцию посту** 
`POST /posts/<post_id>/reaction`

###### request:
```
{
  "reaction": "string"
}
```

###### response
```
{}
```

- **Получение всех постов пользователя, отсортированных по количеству реакций** 
`GET /users/<user_id>/posts`

`asc` обозначет `ascending` (по возрастанию)<br>
`desc` обозначет `descending` (по убыванию)

###### request:
```
{
  "sort": "asc/desc"
}
```

###### response:
```
{
	"posts": [
    	{
  			"id": "number",
  			"author_id": "string",
  			"text": "string",
  			"reactions": [
  				"string",
    			...
  			] 
  		},
        {
        	...
        }
    ]
}
```

- **Получение всех пользователей, отсортированных по количеству реакций** 
`GET /users/leaderboard`

`asc` обозначет `ascending` (по возрастанию)<br>
`desc` обозначет `descending` (по убыванию)

###### request:
```
{
  "type": "list",
  "sort": "asc/desc"
}
```

###### response:
```
{
	"users": [
    	{
          "id": "number",
          "first_name": "string",
          "last_name": "string",
          "email": "string",
          "total_reactions": "number"
		},
        {
        	...
        }
    ]
}
```

- **Получение графика пользователей по количеству реакций** 
`GET /users/leaderboard` (указывать тип сортировки здесь не требуется)


###### request:
```
{
  "type": "graph",
}
```

###### response:
```
<img src="leaderboard.png">
```